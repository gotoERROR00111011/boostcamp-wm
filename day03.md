# day03

## Crawling

![](./images/day02_crawler.png)

크롤링은 웹의 하이퍼링크를 활용해 데이터를 수집하는 기술이다.

하나의 웹페이지를 분석하는 것을 scraping 이라고 부르고, 웹페이지 내부의 하이퍼링크 경로를 따라가며 정보 수집을 하는것을 crawling 이라고 부른다.
최근에는 둘다 crawling 이라고 부르는 경향이 있지만, 사실은 다르다.

이제 누구나 알고있는 기업 구글의 시작 또한 크롤링을 사용한 검색시스템이고 지금까지 널리 쓰이고 있다.

### HTTP 요청과, 구문분석기

crawler 는 사용 목적에 따라 여러가지 기능이 있다.

하지만 공통적으로 HTTP 요청과 구문분석기는 포함된다.
우선 해당 url에 html을 요청하는 기능은 필수적이다.
또한 단순 html은 사람의 눈으로 보기에 무리가 있다.
그래서 html tag 로 쉽게 찾을 수 있는 구문분석기를 사용한다.

### 서버 부담

crawling 을 하는 클라이언트는 url 만 담아서 요청을 보내면 끝이다.
하지만 서버는 요청에 맞추어 페이지 내용을 처리 등 상대적으로 많은 일을 해야한다.
그리고 서버는 유저 한명만 상대하지 않는다.

그래서 서버에 부담을 주지 않도록 처리하는 것 또한 중요한 기술이다.

예를들어 중간에 sleep 을 넣어주는 방법이다.
이것만으로도 서버의 부담을 많이 줄일 수 있다.

그리고 하이퍼링크 목록에서 다양한 사이트를 넓게 찾도록 처리하는 방법도 있다.
DFS 구조처럼 첫 사이트부터 깊게 찾으면 당연히 해당 사이트에 부담이 집중된다.

서버 부담을 줄이는 것은 단순히 윤리적인 의견으로 보일수도 있다.
하지만 잊지 말자.
서버측에서 우리를 차단할수도 있다.

### robots.txt

https://www.google.com/robots.txt (구글의 robots.txt)

공개된 web 환경이지만 규제가 없는것은 아니다.

web server host 들은 robots.txt를 만들어둔다.
여기에는 crawling 허가 여부를 하위 경로마다 기록해 놓는다.
이 내용은 강제적으로 멈추게 하는건 아니고, 아직은 안내사항에 가깝다.

아직 법적 기준은 모호하지만, 실제 재판 사례가 있다.

채용공고를 메인 서비스로 하는 잡코OO 와 사람O 사이에서 crawling 과 관련된 재판이다.
결과는 crawling 을 한 기업측이 손해배상을 해야한다는 것이었다.

물론, crawling 으로 얻은 정보 자체가 그 기업의 핵심 기능이고, 경쟁 기업이라는 이유가 없으면 재판까지 가는 일은 별로 없을것이다.
그렇더라도 피할수 있는것은 피하도록 하자.

## Cache Replacement Policies

메모리의 용량은 한정되어 있다.

캐시의 용량은 더 한정되어 있다.

캐시 정책은 이처럼 한정된 용량을 활용하기 위한 정책이다.
핵심은 자주하는 사용하는 데이터를 캐시에 올려 유지하고, 상대적으로 적게 사용하는 데이터는 반대로 내리는 것이다.

### 동작

하드디스크의 접근할 때, 우선 해당 데이터(page)의 addres가 캐시에 포함되어 있는지 확인한다.
그 다음 메모리, 그리고 하드디스크에 접근한다.

이때 캐시에 있었을 경우 hit, 없었을 경우 miss 라고 한다.
hit 했을 경우 그만큼 시간이 단축된다.
hit 수를 늘리는 것이 캐시 정책의 목적 중 하나다.

### LRU

![](./images/day02_lru.png)

LRU 는 접근 기록이 가장 오래된 것부터 삭제하는 방식이다.

자주 사용하는 데이터를 캐시에 유지할 수 있는 장점이 있다.
하지만 사용 정보를 추적, 관리 해야하는 단점이 있다.

linked list 로 구현할 수 있다.

## 참고

-   [web crawler](https://www.cloudflare.com/ko-kr/learning/bots/what-is-a-web-crawler/)
-   [crawler](https://ko.wikipedia.org/wiki/%EC%9B%B9_%ED%81%AC%EB%A1%A4%EB%9F%AC)
-   [크롤링 재판](https://www.joongang.co.kr/article/25064802#home)
-   [wiki - cash](https://en.wikipedia.org/wiki/Cache_replacement_policies)
-   [캐시 메모리](https://wikidocs.net/65523)
